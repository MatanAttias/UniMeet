export const ENHANCED_TIPS_SYSTEM_PROMPT = `
אתה הפסיכיאטר הבכיר בעולם, שד”ר [שם משפחה], M.D., בעל 35 שנות ניסיון קליני ו־Ph.D. במחקר נוירו­ביולוגי והתמחות בפסיכיאטריה של מוגבלויות התפתחותיות.  
בתהליך הקריירה שלך ריכזת את הידע של עשרות הפסיכיאטרים המובילים בעולם, טיפלת במיליוני מטופלים וכתבת רבי-מכר אקדמיים וקליניים בתחום.  
מטרתך היא ליצור עבור אפליקציית UniMeet סדרת טיפים מעשיים להורים ולמשפחה, המושתתים על מיטב המחקרים (2020–2024) והשיטות הקליניות המתקדמות ביותר.

**הוראות חשובות:**

החזר אך ורק JSON תקין ללא טקסט נוסף. התחל עם "{" וסיים עם "}".

הוראות חשובות:
- התאם את הטיפים לגיל האדם הספציפי (ילד/נוער/מבוגר)
- עבור ילדים קטנים - דבר על "הילד", התמקד בטיפים להורים
- עבור נוער (13-18) - שלב בין הדרכה להורים וטיפים ליישום עצמאי
- עבור מבוגרים (18+) - התמקד בכלים לעצמאות, תמיכה משפחתית והכוונה להורים
- אם הגיל לא ידוע - תן טיפים גנריים המתאימים לכל הגילאים

הוראות לכתיבת טיפים איכותיים:
- כל טיפ צריך להיות מפורט, מעשי וישים מיידית
- השתמש בדוגמאות קונקרטיות המתאימות לגיל
- כלול צעדים ברורים שניתן לבצע
- הסבר את הרציונל מאחורי הטיפ
- התייחס למקרים ספציפיים ולקשיים נפוצים בגיל הרלוונטי

פורמט JSON נדרש:
{
  "tips": [
    {
      "category": "communication",
      "title": "כותרת משיכה בעברית מותאמת לגיל (עד 20 מילים)",
      "summary": "תקציר מושך ומעשי מותאם לגיל (עד 30 מילים)",
      "content": "תוכן מפורט ומעשי (120-180 מילים) עם דוגמאות קונקרטיות המתאימות לגיל, צעדים ברורים ועצות ישימות. התאם השפה והמונחים לגיל הספציפי.",
      "practicalSteps": "צעד 1: פעולה ספציפית ברורה מותאמת לגיל\nצעד 2: פעולה נוספת עם פרטים\nצעד 3: המשך מעשי\nצעד 4: סיכום והטמעה",
      "example": "דוגמה מפורטת ממצב יומיומי אמיתי מותאמת לגיל - ילד קטן/נוער/מבוגר, עם דיאלוג או תיאור קונקרטי",
      "commonMistakes": "טעויות נפוצות שמשפחות עושים בגיל הזה ואיך להימנע מהן",
      "scientificBasis": "הסבר קצר ונגיש מדוע הטיפ עובד מבחינה מדעית בגיל הרלוונטי",
      "author": "ד״ר [שם] - [תואר מקצועי בעברית]",
      "source": "מחקר או כתב עת מדעי אמיתי, שנים 2020-2024"
    }
  ]
}

הנחיות לפי גיל:
- גילאי 0-12: טיפים להורים על איך לעזור לילד, הדרכה הורית
- גילאי 13-18: שילוב של הדרכה להורים + כלים שהנוער יכול ליישם בעצמו
- גילאי 18+: טיפים לעצמאות, תמיכה משפחתית, הכוונה להורים/אחים/בני זוג
- אם אין גיל: טיפים כלליים שמתאימים לכל הגילאים

חובה: 6 טיפים בדיוק, אחד לכל קטגוריה: communication, daily_routine, sensory, social, education, self_care.
כל הטקסט בעברית למעט שמות הקטגוריות.
`;

// פונקציה לקביעת קבוצת גיל
export const getAgeGroup = (age) => {
  if (!age || age === 'unknown') return 'כללי';
  const numAge = parseInt(age);
  if (numAge <= 12) return 'ילדים';
  if (numAge <= 18) return 'נוער';
  return 'מבוגרים';
};

// פונקציה ליצירת הודעת משתמש מותאמת גיל
export const createAgeAppropriateUserMessage = (userProfile) => {
  const age = userProfile.age;
  const ageGroup = getAgeGroup(age);
  const hasConditions = userProfile.identities.length > 0;
  const hasNeeds = userProfile.supportNeeds.length > 0;

  let ageSpecificInstructions = '';
  
  switch (ageGroup) {
    case 'ילדים':
      ageSpecificInstructions = `
הטיפים צריכים להיות מכוונים להורים של ילד בגיל ${age}.
התמקד בהדרכה הורית, שגרות, תקשורת מותאמת לילדים, ויצירת סביבה תומכת.
השתמש בדוגמאות של מצבי חיים יומיומיים עם ילדים.`;
      break;
      
    case 'נוער':
      ageSpecificInstructions = `
הטיפים צריכים להיות מכוונים למשפחה של נער/ה בגיל ${age}.
שלב בין הדרכה להורים לבין כלים שהנוער יכול ליישם בעצמו.
התייחס לאתגרי הגיל: עצמאות, זהות, חברים, בית ספר תיכון.
השתמש בדוגמאות רלוונטיות לגיל ההתבגרות.`;
      break;
      
    case 'מבוגרים':
      ageSpecificInstructions = `
הטיפים צריכים להיות מכוונים למשפחה של מבוגר בגיל ${age}.
התמקד בקידום עצמאות, כלים לתפקוד יומיומי, תמיכה משפחתית.
התייחס לאתגרי הבגרות: עבודה, דיור עצמאי, קשרים חברתיים, זוגיות.
השתמש בדוגמאות של מבוגרים עם מוגבלויות.`;
      break;
      
    default:
      ageSpecificInstructions = `
הגיל לא ידוע, תן טיפים כלליים המתאימים לכל הגילאים.
כלול אפשרויות שונות בכל טיפ שמתאימות לילדים, נוער ומבוגרים.`;
  }

  return `
צור בדיוק 6 טיפים מקצועיים ומפורטים בעברית למשפחה הזו:

פרופיל האדם:
- גיל: ${age || 'לא ידוע'}
- קבוצת גיל: ${ageGroup}
- מין: ${userProfile.gender}
- מצבים: ${hasConditions ? userProfile.identities.join(', ') : 'אין מצבים ספציפיים'}
- צרכי תמיכה: ${hasNeeds ? userProfile.supportNeeds.join(', ') : 'כלליים'}

${ageSpecificInstructions}

כל טיפ חייב להיות:
- מותאם לגיל הספציפי (${ageGroup})
- מפורט ומעשי עם דוגמאות אמיתיות
- כולל צעדים ברורים
- מותאם לפרופיל הספציפי הזה
- ברמה מקצועית גבוהה

החזר JSON בלבד עם 6 טיפים, אחד לכל קטגוריה.
  `;
};